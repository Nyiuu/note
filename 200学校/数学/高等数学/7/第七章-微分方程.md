# 第七章 微分方程

你好！今天我们来复习第七章——微分方程。这一章是连接微积分与更广阔应用领域的桥梁。无论是物理学中的运动定律，还是经济学中的增长模型，都可以用微分方程来精确描述。

## 核心知识点

本章的核心内容可以分为以下几个模块：
1.  **微分方程的基本概念**：理解阶、解、通解、特解等术语。
2.  **一阶微分方程**：掌握几种常见类型（可分离变量、齐次、一阶线性）的求解方法。
3.  **可降阶的高阶微分方程**：学习特定形式的高阶方程如何降阶求解。
4.  **高阶线性微分方程**：这是本章的重点，特别是常系数线性微分方程的解法。

---

### 一、 微分方程的基本概念

- **定义**：凡是表示未知函数、未知函数的导数与自变量之间关系的方程，就叫做**微分方程**。
- **阶**：微分方程中所出现的未知函数的最高阶导数的阶数，叫做微分方程的**阶**。
- **解**：使得微分方程成立的函数。
- **通解**：解中含有**独立的**任意常数，且常数的个数与方程的阶数相同。
- **特解**：通解中的常数被确定了具体的值后得到的解。
- **初始条件**：用于确定特解的条件，例如 $y(x_0)=y_0, y'(x_0)=y_1$ 等。

---

### 二、 一阶微分方程

#### 2.1 可分离变量的微分方程

- **形式**：$g(y)dy = f(x)dx$
- **解法**：如果一个一阶方程可以化为该形式，只需两边同时积分即可：
  $\int g(y)dy = \int f(x)dx + C$

> **例题 1**
>
> 求微分方程 $\frac{dy}{dx} = 2xy$ 的通解。
>
> **解：**
>
> 1.  分离变量：
>     当 $y \neq 0$ 时，可变形为 $\frac{dy}{y} = 2x dx$
>
> 2.  两边积分：
>     $\int \frac{dy}{y} = \int 2x dx$
>     $\ln|y| = x^2 + C_1$
>
> 3.  化简：
>     $|y| = e^{x^2 + C_1} = e^{C_1}e^{x^2}$
>     令 $C = \pm e^{C_1}$，则 $y = Ce^{x^2}$。
>     （当 $y=0$ 时，也是原方程的解，此时 $C=0$）
>     所以通解为 $y = Ce^{x^2}$。

#### 2.2 齐次方程

- **形式**：可化为 $\frac{dy}{dx} = \varphi(\frac{y}{x})$ 的形式。
- **解法**：
    1.  做代换，令 $u = \frac{y}{x}$，则 $y=ux$，$\frac{dy}{dx} = u + x\frac{du}{dx}$。
    2.  原方程变为 $u + x\frac{du}{dx} = \varphi(u)$，这是一个可分离变量的方程。
    3.  分离变量得 $\frac{du}{\varphi(u)-u} = \frac{dx}{x}$。
    4.  积分后，再将 $u=\frac{y}{x}$ 代回即可。

> **例题 2**
>
> 求方程 $(x^2+y^2)dx - xy dy = 0$ 的通解。
>
> **解：**
>
> 1.  变形：
>     当 $x \neq 0, y \neq 0$ 时，$\frac{dy}{dx} = \frac{x^2+y^2}{xy} = \frac{x}{y} + \frac{y}{x}$。
>
> 2.  令 $u = \frac{y}{x}$，则 $\frac{dy}{dx} = u + x\frac{du}{dx}$。方程变为：
>     $u + x\frac{du}{dx} = \frac{1}{u} + u$
>     $x\frac{du}{dx} = \frac{1}{u}$
>
> 3.  分离变量并积分：
>     $u du = \frac{dx}{x}$
>     $\int u du = \int \frac{dx}{x}$
>     $\frac{1}{2}u^2 = \ln|x| + C_1$
>
> 4.  代回并整理：
>     $\frac{1}{2}(\frac{y}{x})^2 = \ln|x| + C_1$
>     $y^2 = 2x^2(\ln|x| + C_1) = x^2(2\ln|x| + C)$
>     $y^2 = x^2(\ln(x^2) + C)$

#### 2.3 一阶线性微分方程

- **形式**：$\frac{dy}{dx} + P(x)y = Q(x)$
- **通解公式**：$y = e^{-\int P(x)dx} \left( \int Q(x)e^{\int P(x)dx}dx + C \right)$
- **记忆技巧**：这个公式比较复杂，但其推导过程（常数变易法）很有启发性，也可以直接记住公式求解。

> **通解公式推导 (常数变易法)**
>
> 1.  **第一步：求解对应的齐次方程**
>     对应的齐次方程为 $\frac{dy}{dx} + P(x)y = 0$。
>     这是一个可分离变量的方程，分离变量得 $\frac{dy}{y} = -P(x)dx$。
>     两边积分：$\ln|y| = -\int P(x)dx + C_1$。
>     其通解为 $y_h = Ce^{-\int P(x)dx}$ (其中 $C=\pm e^{C_1}$)。
>
> 2.  **第二步：常数变易**
>     我们将齐次解中的常数 $C$ 替换为一个关于 $x$ 的未知函数 $u(x)$，并假设非齐次方程的解具有以下形式：
>     $y = u(x)e^{-\int P(x)dx}$
>
> 3.  **第三步：求导并代入原非齐次方程**
>     利用乘积求导法则对 $y$ 求导：
>     $y' = u'(x)e^{-\int P(x)dx} + u(x) \cdot e^{-\int P(x)dx} \cdot (-P(x))$
>     将 $y$ 和 $y'$ 代入原方程 $\frac{dy}{dx} + P(x)y = Q(x)$：
>     $[u'(x)e^{-\int P(x)dx} - u(x)P(x)e^{-\int P(x)dx}] + P(x)[u(x)e^{-\int P(x)dx}] = Q(x)$
>
> 4.  **第四步：化简并求解 u(x)**
>     方程中含有 $u(x)$ 的项恰好相互抵消，剩下：
>     $u'(x)e^{-\int P(x)dx} = Q(x)$
>     解得 $u'(x) = Q(x)e^{\int P(x)dx}$。
>     对上式两边积分，得到 $u(x)$：
>     $u(x) = \int Q(x)e^{\int P(x)dx}dx + C$ (这里的C是积分常数)
>
> 5.  **第五步：写出最终通解**
>     将求出的 $u(x)$ 代回到第二步的假设中，即得到最终的通解公式：
>     $y = \left( \int Q(x)e^{\int P(x)dx}dx + C \right) e^{-\int P(x)dx}$

> **例题 3**
>
> 求方程 $\frac{dy}{dx} - \frac{y}{x} = x^2$ 的通解。
>
> **解：**
>
> 1.  确定 $P(x)$ 和 $Q(x)$：
>     $P(x) = -\frac{1}{x}$
>     $Q(x) = x^2$
>
> 2.  计算积分因子中的积分：
>     $\int P(x)dx = \int -\frac{1}{x}dx = -\ln|x| = \ln|\frac{1}{x}|$
>
> 3.  套用通解公式：
>     $y = e^{-(-\ln|x|)} \left( \int x^2 e^{-\ln|x|} dx + C \right)$
>     $y = e^{\ln|x|} \left( \int x^2 \cdot \frac{1}{|x|} dx + C \right)$
>     为方便计算，不妨设 $x>0$，则
>     $y = x \left( \int x^2 \cdot \frac{1}{x} dx + C \right)$
>     $y = x \left( \int x dx + C \right)$
>     $y = x \left( \frac{1}{2}x^2 + C \right)$
>     $y = \frac{1}{2}x^3 + Cx$

---

### 三、 可降阶的高阶微分方程

某些特殊形式的高阶微分方程可以通过适当的变量代换，降低其阶数，从而简化求解。

#### 3.1 $y^{(n)} = f(x)$ 型

- **解法**：直接对 $f(x)$ 连续积分 $n$ 次即可。

> **例题 4**
>
> 求方程 $y''' = e^{2x} + \sin x$ 的通解。
>
> **解：**
>
> 1.  一次积分：$y'' = \int (e^{2x} + \sin x)dx = \frac{1}{2}e^{2x} - \cos x + C_1$
> 2.  二次积分：$y' = \int (\frac{1}{2}e^{2x} - \cos x + C_1)dx = \frac{1}{4}e^{2x} - \sin x + C_1x + C_2$
> 3.  三次积分：$y = \int (\frac{1}{4}e^{2x} - \sin x + C_1x + C_2)dx = \frac{1}{8}e^{2x} + \cos x + \frac{C_1}{2}x^2 + C_2x + C_3$
>     （可以将 $\frac{C_1}{2}$ 记为新的任意常数）

#### 3.2 $y'' = f(x, y')$ 型（不显含y）

- **解法**：令 $p = y'$，则 $y'' = \frac{dp}{dx}$。原方程化为一阶微分方程 $\frac{dp}{dx} = f(x, p)$。解出 $p$ 后，再通过 $y = \int p dx$ 求解。

#### 3.3 $y'' = f(y, y')$ 型（不显含x）

- **解法**：令 $p = y'$，则 $y'' = \frac{dp}{dx} = \frac{dp}{dy}\frac{dy}{dx} = p\frac{dp}{dy}$。原方程化为关于 $p$ 和 $y$ 的一阶方程 $p\frac{dp}{dy} = f(y, p)$。

---

### 四、 高阶线性微分方程

这是本章的核心内容。

#### 4.1 解的结构

对于二阶线性微分方程 $y'' + P(x)y' + Q(x)y = f(x)$：

- **齐次方程**：如果 $f(x) \equiv 0$，方程为齐次的。
- **非齐次方程**：如果 $f(x) \not\equiv 0$，方程为非齐次的。

**叠加原理**：
1.  如果 $y_1(x), y_2(x)$ 是齐次方程的两个解，那么它们的线性组合 $C_1y_1(x)+C_2y_2(x)$ 也是该齐次方程的解。
2.  **非齐次方程的通解 = 对应齐次方程的通解 + 非齐次方程的一个特解**。
    即 $Y(x) = y_h(x) + y_p(x)$。

#### 4.2 二阶常系数齐次线性微分方程

- **形式**：$y'' + py' + qy = 0$ (p, q为常数)
- **特征方程**：$r^2 + pr + q = 0$
- **通解求解步骤**：
    1.  写出特征方程。
    2.  求解特征根 $r_1, r_2$。
    3.  根据特征根的情况写出通解：
        -   **两个不等的实根** $r_1 \neq r_2$：$y = C_1e^{r_1x} + C_2e^{r_2x}$
        -   **两个相等的实根** $r_1 = r_2 = r$：$y = (C_1 + C_2x)e^{rx}$
        -   **一对共轭复根** $r = \alpha \pm i\beta$：$y = e^{\alpha x}(C_1\cos(\beta x) + C_2\sin(\beta x))$

#### 4.3 二阶常系数非齐次线性微分方程

- **形式**：$y'' + py' + qy = f(x)$
- **解法**（待定系数法）：
    1.  求出对应齐次方程的通解 $y_h$。
    2.  观察 $f(x)$ 的形式，设定特解 $y_p$ 的形式（带待定系数）。
    3.  将 $y_p$ 代入原方程，解出待定系数。
    4.  通解 $Y = y_h + y_p$。

- **$f(x)$ 的两种常见类型及特解的设定**：

    1.  **$f(x) = P_m(x)e^{ax}$ 型** (多项式乘以指数函数)
        -   设 $y_p = x^k Q_m(x)e^{ax}$，其中 $Q_m(x)$ 是与 $P_m(x)$ 同次的一般多项式。
        -   $k$ 的取值取决于 $a$ 是否为特征方程的根：
            -   $a$ **不是**特征根：$k=0$
            -   $a$ **是**特征方程的单根：$k=1$
            -   $a$ **是**特征方程的重根：$k=2$

    2.  **$f(x) = e^{ax}[P_l(x)\cos(\omega x) + P_n(x)\sin(\omega x)]$ 型**
        -   设 $y_p = x^k e^{ax}[R_m(x)\cos(\omega x) + S_m(x)\sin(\omega x)]$，其中 $m = \max(l, n)$，$R_m, S_m$ 是m次一般多项式。
        -   $k$ 的取值取决于 $a+i\omega$ 是否为特征方程的根：
            -   $a+i\omega$ **不是**特征根：$k=0$
            -   $a+i\omega$ **是**特征方程的根：$k=1$

> **例题 5**
>
> 求 $y'' - 2y' - 3y = 3x+1$ 的通解。
>
> **解：**
>
> 1.  **求齐次通解 $y_h$**
>     特征方程：$r^2 - 2r - 3 = 0 \Rightarrow (r-3)(r+1)=0$
>     特征根：$r_1=3, r_2=-1$
>     齐次通解：$y_h = C_1e^{3x} + C_2e^{-x}$
>
> 2.  **求非齐次特解 $y_p$**
>     $f(x) = (3x+1)e^{0x}$。这里 $a=0$，它不是特征根，所以 $k=0$。
>     设 $y_p = Ax+B$。
>     $y_p' = A$, $y_p'' = 0$。
>     代入原方程：$0 - 2(A) - 3(Ax+B) = 3x+1$
>     $-3Ax + (-2A-3B) = 3x+1$
>     比较系数得：
>     $\begin{cases} -3A = 3 \\ -2A-3B = 1 \end{cases} \Rightarrow \begin{cases} A = -1 \\ B = \frac{1}{3} \end{cases}$
>     所以特解 $y_p = -x + \frac{1}{3}$
>
> 3.  **合并通解**
>     $Y = y_h + y_p = C_1e^{3x} + C_2e^{-x} - x + \frac{1}{3}$

---

教授总结：

同学，第七章微分方程的内容至此也复习完毕了。我们从基本概念入手，系统学习了一阶、可降阶以及高阶线性微分方程的求解策略。特别是常系数线性微分方程，其解法规律性强，是必须熟练掌握的重点。希望这份文档能帮助你巩固知识，解决疑难。

--- 